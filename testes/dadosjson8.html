<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informações do Pokémon</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; background-color: #f9f9f9; }
        .pokemon-card {
            background-color: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin: 15px;
            width: 250px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: inline-block;
            vertical-align: top;
            text-align: center;
            transition: border-color 0.3s, background-color 0.3s;
        }
        .card-com-erro {
            border-color: #e53e3e;
            background-color: #fff5f5;
        }
        .pokemon-card h2 { color: #333; margin-top: 0; }
        .pokemon-card h3 { border-bottom: 1px solid #eee; padding-bottom: 5px; text-align: left;}
        .pokemon-card p { margin: 5px 0; text-align: left; }
        .pokemon-images {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            min-height: 100px;
        }
        .pokemon-images img {
            max-width: 100px;
            height: auto;
        }
        .pokemon-card{
            display: none;
        }
        .pokemon-card.card-com-erro{
            display: inline-block;
        }
    </style>
</head>
<body>

    <h1>Dados do Pokémon</h1>
    <div id="pokemon-info">
        </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('pokemon-info');

            const promessaDadosPrincipais = fetch('/json/poke_data.json').then(res => res.json());
            const promessaImagensPrimarias = fetch('/testes/imagens_pokemon.json').then(res => res.json());
            const promessaImagensAlternativas = fetch('/testes/imagens_pokemon_alt.json').then(res => res.json());

            Promise.all([promessaDadosPrincipais, promessaImagensPrimarias, promessaImagensAlternativas])
                .then(([todosPokemons, imagensPrimarias, imagensAlternativas]) => {
                    
                    const mapaImagensPrimario = new Map(imagensPrimarias.map(item => [item.nome, item]));
                    const mapaImagensAlternativo = new Map(imagensAlternativas.map(item => [item.name, item]));

                    todosPokemons.forEach(pokemon => {
                        const card = document.createElement('div');
                        card.className = 'pokemon-card';

                        const nomeOriginal = pokemon.speciesName;

                        // LÓGICA DE TRADUÇÃO DE NOMES EXPANDIDA
                        const nomeFinal = nomeOriginal
                            // NOVO: Formas especiais de Pikachu
                            .replace('Pikachu (5th Anniversary)', 'Pikachu 5th Aniversário')
                            .replace('Pikachu (Flying)', 'Pikachu Voador')
                            .replace('Pikachu (Horizons)', 'Pikachu Horizons')
                            .replace('Pikachu (Kariyushi)', 'Pikachu Kariyushi')
                            .replace('Pikachu (Libre)', 'Pikachu Libre')
                            .replace('Pikachu (Pop Star)', 'Pikachu Pop Star')
                            .replace('Pikachu (Rock Star)', 'Pikachu Rock Star')
                            .replace('Pikachu (Shaymin Scarf)', 'Pikachu Shaymin Scarf')
                            
                            // Casos especiais existentes
                            .replace('Nidoran Male', 'Nidoran♂')
                            .replace('Nidoran Female', 'Nidoran♀')
                            
                            // Formas regionais existentes
                            .replace('(Alolan)', 'de Alola')
                            .replace('(Galarian)', 'de Galar')
                            .replace('(Hisuian)', 'de Hisui')
                            .replace('(Paldean)', 'de Paldea')

                            // tauros regionais
                            .replace('Tauros (Aqua)', 'Tauros de Paldea Espécie de Combate')
                            .replace('Tauros (Blaze)', 'Tauros de Paldea Espécie Labareda')
                            .replace('Tauros (Combat)', 'Tauros de Paldea Espécie Aquática')

                            .replace('Mewtwo (Armored)', 'Mewtwo de Armadura')
                            
                            .replace('Castform (Sunny)', 'Castform Emsolarada')
                            .replace('Castform (Rainy)', 'Castform Chuvosa')
                            .replace('Castform (Snowy)', 'Castform Nevada')
                            
                            .replace('Deoxys (Attack)', 'Deoxys Forma Ataque')
                            .replace('Deoxys (Defense)', 'Deoxys Forma Defesa')
                            .replace('Deoxys (Speed)', 'Deoxys Forma Velocidade')
                            
                            .replace('Burmy (Plant)', 'Burmy Manto Vegetal')
                            .replace('Burmy (Sandy)', 'Burmy Manto Arenoso')
                            .replace('Burmy (Trash)', 'Burmy Manto de Lixo')
                            
                            .replace('Wormadam (Plant)', 'Wormadam Manto Vegetal')
                            .replace('Wormadam (Sandy)', 'Wormadam Manto Arenoso')
                            .replace('Wormadam (Trash)', 'Wormadam Manto de Lixo');
                            
                        // O resto do código continuaTauros (Combat) igual
                        const infoImagensPrimario = mapaImagensPrimario.get(nomeFinal);
                        let urlImgNormal = infoImagensPrimario ? infoImagensPrimario.imgNormal : null;
                        let urlImgShiny = infoImagensPrimario ? infoImagensPrimario.imgShiny : null;

                        if (!urlImgNormal || !urlImgShiny) {
                            const chaveAlternativa = pokemon.speciesId;
                            const infoImagensAlt = mapaImagensAlternativo.get(chaveAlternativa);

                            if (infoImagensAlt) {
                                if (!urlImgNormal && infoImagensAlt.imgNormal) {
                                    urlImgNormal = infoImagensAlt.imgNormal;
                                }
                                if (!urlImgShiny && infoImagensAlt.imgShiny) {
                                    urlImgShiny = infoImagensAlt.imgShiny;
                                }
                            }
                        }
                        
                        if (!urlImgNormal || !urlImgShiny) {
                            card.classList.add('card-com-erro');
                        }

                        let htmlImagens = '';
                        if (urlImgNormal) {
                            htmlImagens += `<img src="${urlImgNormal}" alt="${nomeFinal} Normal">`;
                        }
                        if (urlImgShiny) {
                            htmlImagens += `<img src="${urlImgShiny}" alt="${nomeFinal} Shiny">`;
                        }
                        
                        card.innerHTML = `
                            <div class="pokemon-images">
                                ${htmlImagens}
                            </div>
                            <h2>${nomeFinal}</h2>
                            <p><strong>Dex:</strong> ${pokemon.dex}</p>
                            
                            <h3>Atributos Base</h3>
                            <p><strong>Ataque:</strong> ${pokemon.baseStats.atk}</p>
                            <p><strong>Defesa:</strong> ${pokemon.baseStats.def}</p>
                            <p><strong>HP:</strong> ${pokemon.baseStats.hp}</p>
                        `;

                        container.appendChild(card);
                    });
                })
                .catch(error => {
                    console.error('Falha ao carregar ou processar os arquivos JSON:', error);
                    container.innerHTML = '<p>Não foi possível carregar os dados dos Pokémon. Verifique o console para mais detalhes.</p>';
                });
        });
    </script>

</body>
</html>